<!DOCTYPE html>
<html>
<head>
<title>
  Reverse phonetic dictionary based on CMUDict, includes a lyrics editor and vowel sound synthesizer
</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<script type="text/javascript" src="piano.js"></script>
<link rel="preconnect" href="https://fonts.gstatic.com"/>
<link href='https://fonts.googleapis.com/icon?family=Material+Icons' rel='stylesheet'/>
<style>
@font-face {
  font-family: "DejaVu";
  src: url("fonts/dejavu/DejaVuSansMono.ttf") format("truetype");
}
@font-face {
  font-family: "DejaVuBold";
  src: url("fonts/dejavu/DejaVuSansMono-Bold.ttf") format("truetype");
}
@font-face {
  font-family: "DejaVuSans";
  src: url("fonts/dejavu/DejaVuSans.ttf") format("truetype");
}
@font-face {
  font-family: "DejaVuSansBold";
  src: url("fonts/dejavu/DejaVuSans-Bold.ttf") format("truetype");
}
* {
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
  font-family: 'DejaVu', 'DejaVuSans', monospace;
}
body, html {
  margin:0;
  padding:0;
  overflow:hidden;
  font-size:16px;
}
textarea, input, datalist, button, pre {
  font-size: 16px;
}
input, datalist, button {
  margin:0px;
  padding:0px 2px;
  border:1px solid lightgray;
}
ul {
  list-style-type: none;
  padding: 0;
  margin: 0;
}
li {
  cursor: pointer;
}
#spectrogram {
  padding:0;
}
#b {
  line-height:1.1em;
  letter-spacing:-0.15em;
  width:99%;
  height:224px;
  font-weight:bold;
  white-space:nowrap;
  overflow:scroll;
  background-color:white;
  color:black;
  margin:0;
  padding:2px;
  text-align:left;
}
#buttons {
  height:32px;
  margin-left:3px;
  text-align:left;
}
#buttons button {
  width:32px;
  height:32px;
  font-weight:bold;
  font-size:16px;
  margin:0px -3px;
}
#buttons button i {
  margin-top:3px;
}
#checkboxes {
  width:72px;
  position:fixed;
  top:25vh;
  right:0px;
  left:auto;
  padding-right:4px;
  background-color:white;
}
#p, #ch {
  position: absolute;
  right: -0.067em;
  top: 0.025em;
  font-size: 128px;
  font-weight: bold;
  line-height: 1em;
  z-index:-1;
}
#p {
  color:lightgray;
}
#left {
  width:32px;
  float:left;
  padding:2px;
}
#right {
  width:32px;
  float:right;
  padding:2px;
}
.cb {
  width:32px;
  height:32px;
  margin:0;
  padding:0;
  opacity:0;
}
#keys {
  width: 288px;
  margin:0px;
  font-size:16px;
}
#keys_ {
  width: 288px;
  margin:0px;
  font-size:16px;
  letter-spacing:-0.05px;
}
.u {
   text-decoration:underline;
}
a {
  color:black;
  text-decoration:none;
}
#keys a {
  border-left: 1px solid lightgray;
  margin: 0px -1px 0px 0px;
  padding:2.4px;
  font-family:'DejaVuBold';
}
#keys_ span a {
  border-left:1px solid lightgray;
  padding:0px;
  margin:0px -1px 0px 0px;
  font-family:'DejaVuBold';
}
#keys_ a {
  font-family:'DejaVuBold';
}
#tone {
  width:288px;
  height:1.5em;
  line-height:1.5em;
  overflow:scroll;
  background-color:transparent;
  margin-bottom:0.5em;
}
#tone a {
  font-family:'DejaVuBold';
  padding:0px 5px;
}
select {
  height:24px;
  font-size:16px;
  width:24px;
  margin:0px;
  padding:2px 1px;
  border: 0px;
  -o-appearance: none;
  -ms-appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}
option {
  margin:0px;
  padding:0px;
}
#word, #word_ {
  border:1px solid lightgray;
  margin:0px;
  background:white;
  float:left;
}
#word {
  height:20px;
  width:253px;
  padding:1px 2px;
}
#word_ {
  overflow:scroll;
  height:18px;
  width:224px;
  padding:2px;
}
#word_ div {
  cursor: pointer;
  height: 22px;
  border-bottom: 1px solid darkgray;
}
#split, #search, #define {
  width:29px;
  height:24px;
  border:1px solid lightgray;
  margin:0px;
  padding:2px;
  background:#eeeeee;
  float:right;
  font-size:14px;
}
#split i {
  font-size:14px;
  margin-top:4px;
  position:relative;
  right:2px;
  letter-spacing:-4px;
  font-weight:bold;
}
#search i {
  margin-top:-2px;
}
#define i {
  font-size:20px;
}
.l {
  width:100%;
  padding:0px;
  margin:0px;
  clear:both;
}
#vowels {
  width:148px;
  height:22px;
}
#consonants {
  width:128px;
  height:22px;
}
pre {
  padding:0px;
  margin:0px;
  letter-spacing:0px;
}
#highlight, #highlight_ {
  width:50%;
  overflow-y:scroll;
  overflow-x:hidden;
  top:0px;
  position:fixed;
  z-index:-1;
  background:transparent;
  margin:0px;
  padding:0px;
  min-height:128px;
  font-size:16px;
  letter-spacing: 0px;
  color:transparent;
}
#highlight i {
   margin:0px -3px -2px 0px;
   padding:0px 3px 0px 0px;
   border-bottom:2px solid lightgray;
}
#highlight_ i {
   margin:0px;
   padding:0px;
   border:none;
}
#res, #rs {
  position:fixed;
  overflow-y:scroll;
  overflow-x:hidden;
  margin:-1px;
  padding:0px;
  border:1px solid lightgray;
  letter-spacing: 0px;
  background:transparent;
  min-height:128px;
  z-index:0;
}
#highlight, #res {
  left:0px;
  text-align:left;
  display:block;
  white-space: pre;
  line-height:18px;
  font-weight:bold;
}
#highlight_, #rs {
  right:0px;
  text-align:left;
  display:block;
  white-space: pre;
  line-height:18px;
}
#dict {
  width:288px;
  position:fixed;
  left:50%;
  margin-left:-128px;
  background:white;
  bottom:0px;
}
#links {
  position:fixed;
  z-index:10;
  bottom:16px;
  left:0px;
  width:28px;
  padding-left:4px;
  overflow:hidden;
  white-space:nowrap;
  background:white;
  font-size:16px;
}
#links i {
  font-size:20px;
}
#help, #credits, #entry, #mobile, #spectrogram {
  overflow:scroll;
  font-size: 14px;
  height:264px;
  position:fixed;
  left:50%;
  margin-left:-160px;
  background:white;
  width:310px;
  max-width:100vw;
  border:1px solid lightgray;
  padding:2px 4px 2px 4px;
  visibility:hidden;
  z-index:11;
  top:0px;
}
#def {
  height:156px;
  overflow:scroll;
}
#def .material-icons {
  font-size: 16px;
  color: gray;
  top: 3px;
  position: relative;
}
#mobile {
  background-color:lightgray;
  height:4em;
}
@media only screen and (max-height: 511px) {
  #highlight, #highlight_, #res, #rs {
    height:128px;
    width:100%;
  }
  #rs, #highlight_ {
    top:128px;
  }
}
@media only screen and (min-height: 512px) {
  #highlight, #highlight_, #res, #rs {
    height:25vh;
    width:100%;
  }
  #rs, #highlight_ {
    top:25vh;
  }
}
@media only screen and (max-width: 511px) {
  #highlight, #highlight_, #res, #rs {
    height:128px;
    width:100%;
  }
  #rs, #highlight_ {
    top:128px;
  }
}
@media only screen and (min-width: 512px) {
  #highlight, #highlight_, #res, #rs {
    height:100vh;
    width:50%;
  }
  #rs, #highlight_ {
    top:0px;
  }
}
</style>
</head>
<body>

<div id="area">
  <div id="highlight"></div>
  <textarea placeholder="Lyrics" id="res" onkeyup="syllables();" onmouseup="syllables();" ontouchup="syllables();" onfocus="syllables();ctl=this;" onscroll="highlight.scrollTop = this.scrollTop;highlight.scrollLeft = this.scrollLeft;" style="visibility:visible;"></textarea>
  <div id="highlight_"></div>
  <textarea placeholder="Phonetic pattern" id="rs" onkeydown="if(event.key.length==1 && !event.ctrlKey && !event.metaKey){event.preventDefault();}" onkeyup="if(event.key.length==1 && kbrd[event.key] && !event.ctrlKey && !event.metaKey){addPhoneme(kbrd[event.key], 0);}colorPhonemes();" onmouseup="colorPhonemes();" ontouchup="colorPhonemes();" onfocus="colorPhonemes();ctl=this;" onscroll="highlight_.scrollTop = this.scrollTop;highlight_.scrollLeft = this.scrollLeft;" style="visibility:visible;"></textarea>
</div>

  <div id="spectrogram">
    <textarea id="b" onkeydown="if(event.key!='ArrowRight' && event.key!='ArrowLeft' && event.key!='ArrowUp' && event.key!='ArrowDown' && event.key!='Enter' && event.key!='Backspace' && event.key!='Delete' && event.ctrlKey!==true || event.key==' '){event.preventDefault();keysPressed[kbrd[event.key]]=true;addBinary();}" onkeyup="if(event.key!='ArrowRight' && event.key!='ArrowLeft' && event.key!='ArrowUp' && event.key!='ArrowDown' && event.key!='Enter' && event.key!='Backspace' && event.key!='Delete' && event.ctrlKey!==true || event.key==' '){keysPressed[kbrd[event.key]]=false;}else if(event.key=='ArrowRight'||event.key=='ArrowLeft'){showColumn();playColumn();}else if(event.key=='ArrowUp'||event.key=='ArrowDown'){showColumn();}"></textarea>
    
    <div id="checkboxes" oncontextmenu="return false;">
      <div id="left">
        <input type="checkbox" class="cb" onchange="addBinary();" ontouchend="this.click();"/>
        <input type="checkbox" class="cb" onchange="addBinary();" ontouchend="this.click();"/>
        <input type="checkbox" class="cb" onchange="addBinary();" ontouchend="this.click();"/>
        <input type="checkbox" class="cb" onchange="addBinary();" ontouchend="this.click();"/>
      </div>
      <div id="right">
        <input type="checkbox" class="cb" onchange="addBinary();" ontouchend="this.click();"/>
        <input type="checkbox" class="cb" onchange="addBinary();" ontouchend="this.click();"/>
        <input type="checkbox" class="cb" onchange="addBinary();" ontouchend="this.click();"/>
        <input type="checkbox" class="cb" onchange="addBinary();" ontouchend="this.click();"/>
      </div>
      <span id="p">⣿</span>
      <span id="ch">⠀</span>
    </div>
    
    <div id="buttons">
      <button type="button" id="play_all" onclick="if(playNow===true){pause();}else{playAll();}" title="Play / Pause"><i class='material-icons'>play_arrow</i></button>
      <button type="button" id="zoom_in" onclick="zoom(1);" title="Zoom in"><i class='material-icons'>zoom_in</i></button>
      <button type="button" id="zoom_out" onclick="zoom(-1);" title="Zoom out"><i class='material-icons'>zoom_out</i></button>
      <button type="button" id="save" onclick="save();" title="Save as text"><i class='material-icons'>save_alt</i></button>
      <!--<button type="button" id="log_scale" onclick="logScale();" title="Export to image"><i class='material-icons'>gradient</i></button>-->
      <button type="button" id="draw" onclick="window.open('https://loveeevee.github.io/Dots-Converter/');" title="Import a drawing"><i class='material-icons'>draw</i></button>
      <button type="button" id="space" onclick="addBinary();" title="Add space"><i class='material-icons'>space_bar</i></button>
      <button type="button" id="swap" onclick="swap();" title="Move pattern to left or right"><i class='material-icons'>swap_horiz</i></button>
    </div>
  </div>

  <div id="help">
    <p>Use the pitch symbols and groups of vowels to fit the <i>form</i>, <i>rhythm</i> and <i>melody</i>.</p>
    <p>Search <i>keywords</i> or phonemes and add the results to lyrics and phonetic pattern.</p>
    <p>Look up <i>rhymes and alliterations</i> with wildcards, separate for vowels and consonants.</p>
    <p>They can be in any syllables wherever in the text, not necessarily the end of the line.</p>
  </div>
  
  <div id="mobile">On mobile, switch the system keyboard to floating mode.</div>
  
  <div id="credits">
    <p>Reverse phonetic dictionary, includes a lyrics editor and vowel sound synthesizer. Licensed under the GNU GPL-3.0, hosted on <a href="https://github.com/freealise/phonetic" title="Github" target="_blank"><u>GitHub</u></a> and <a href="https://script.google.com" title="Google Script" target="_blank"><u>Google Script</u></a>.</p>
    <p>Dictionary by <a href="http://www.speech.cs.cmu.edu/cgi-bin/cmudict" title="Carnegie Mellon University" target="_blank"><u>CMU</u></a>, sorted by frequency based on <a href="https://books.google.com/ngrams" title="Google Books Ngrams" target="_blank"><u>Google Books Ngrams</u></a> with <a href="https://phrasefinder.io/" title="PhraseFinder" target="_blank"><u>PhraseFinder</u></a> API, <a href="https://dictionaryapi.dev/" title="DictionaryAPI" target="_blank"><u>definitions</u></a> by <a href="https://www.lexico.com/" title="Oxford Dictionary" target="_blank"><u>Oxford</u></a>.</p>
    <p>Thanks to <a href="https://www.gearspace.com/board/showpost.php?p=11559456&amp;postcount=10" title="jerry123 from GearSpace" target="_blank"><u>jerry123 from GearSpace</u></a> for the idea of phonetic songwriting, <a href="https://englishwithkim.com/" title="English with Kim" target="_blank"><u>English with Kim</u></a> for clarifying that words and syllables are stressed with not only volume but also pitch variation.</p>
    <p>Separating vowels and consonants for slant rhyme and alliteration within a line was inspired by rap and Hebrew poetry.</p>
  </div>
  
  <div id="entry">
    <div id="def">Word definitions and usage data will be here</div>
    <iframe id="ngram_chart" name="ngram_chart" src="" width=288 height=100 marginwidth=0 marginheight=0 hspace=0 vspace=0 frameborder=0 scrolling=yes></iframe>
  </div>

  <div id="dict">
    <div class="l"><input type="text" id="word" list="_word" placeholder="Word or phonemes" onfocus="ctl=this;"/><datalist id="_word"></datalist><button onclick="findWords(word.value, vowels.value, consonants.value);" id="search" title="Search"><i class='material-icons'>search</i></button></div>
    <div class="l"><div id="word_" onclick="if(event.target.title){addWord(event.target.innerText, event.target.title);}"><div>Results will be here</div></div>
    <button onclick="pos(word_.firstChild.innerText);" id="define" title="Define"><i class='material-icons'>query_stats</i></button><button onclick="splitWord();" id="split" title="Split"><i class='material-icons'>south_west</i><i class='material-icons'>south_east</i></button></div>
    <div class="l"><input type="text" id="vowels" list="vowels_" placeholder="Vowels" onfocus="ctl=this;"/><datalist id="_vowels"></datalist><datalist id="vowels_"></datalist><input type="text" id="consonants" list="consonants_" placeholder="Consonants" onfocus="ctl=this;"/><datalist id="_consonants"></datalist><datalist id="consonants_"></datalist></div>
    
    <pre oncontextmenu="return false;" id="keys_">
<span class="u"><a title="B">  </a><a title="P">  </a></span>         <span class="u"><a title="D">  </a><a title="T">  </a></span>  <span class="u"><a title="JH">  </a><a title="CH">  </a></span>   <span class="u"><a title="G">  </a><a title="K">  </a></span>
<span class="u"><a title="V">  </a><a title="F">  </a></span>  <span class="u"><a title="DH">  </a><a title="TH">  </a></span>   <span class="u"><a title="Z">  </a><a title="S">  </a></span>  <span class="u"><a title="ZH">  </a><a title="SH">  </a></span>   <span class="u"><a title="R">  </a><a title="HH">  </a></span>
<span class="u"><a title="W">  </a><a title="M">  </a></span>  <span class="u"><a title="_">  </a></span>     <span class="u"><a title="L">  </a><a title="N">  </a></span>         <span class="u"><a title="Y">  </a><a title="NG">  </a></span>
          <a title="Wildcard" href="javascript:" onclick="addPhoneme('-', 'transparent');">- </a>       <a title="Extra pitch level" onmousedown="mobile.innerText=this.title;" href="javascript:" onclick="addPhoneme('`', 'transparent');">` </a> <a title="Word divider" onmousedown="mobile.innerText=this.title;" href="javascript:" onclick="addPhoneme('|', 'transparent');">| </a></pre>
    <pre oncontextmenu="return false;" id="keys">
<select title="IY"></select><select title="IH"></select><select title="EY"></select><select title="EH"></select><select title="AE"></select><select title="ER"></select><select title="AH"></select><select title="AA"></select><select title="AO"></select><select title="OW"></select><select title="UH"></select><select title="UW"></select>
<a title="Any stress with any vowel" onmousedown="mobile.innerText=this.title;" href="javascript:" onclick="addPhoneme('___', 'transparent');">__</a><a title="No stress with any vowel" onmousedown="mobile.innerText=this.title;" href="javascript:" onclick="addPhoneme('__0', 'transparent');">_·</a><a title="Primary stress with any vowel" onmousedown="mobile.innerText=this.title;" href="javascript:" onclick="addPhoneme('__1', 'transparent');">_ˈ</a><a title="Secondary stress with any vowel" onmousedown="mobile.innerText=this.title;" href="javascript:" onclick="addPhoneme('__2', 'transparent');">_ˌ</a><select title="AY"></select><select title="OY"></select><select title="AW"></select></pre>
  <div id="tone" title="Pitch symbols for word and syllable stress, span octave (12 semitones) in two rows plus underscores" onmousedown="mobile.innerText=this.title;"></div>
  </div>
  
  <div id="links">
    <a id="show_links" href="javascript:showLinks();" alt="Show links" title="Show links"><i class='material-icons'>chevron_right</i></a><br/>
    <a id="undo" href="javascript:undo();" alt="Undo" title="Undo"><i class='material-icons'>undo</i> Undo</a><br/>
    <a id="pattern" href="javascript:showSpectrogram();" alt="Spectrogram" title="Spectrogram"><i class='material-icons'>app_registration</i> Spectrogram</a><br/>
    <a id="lyrics" href="javascript:showLyrics();" alt="Mobile view" title="Mobile view"><i class='material-icons'>preview</i> Mobile view</a><br/>
    <a id="entry_" href="javascript:showEntry();" alt="Definition" title="Definition"><i class='material-icons'>wysiwyg</i> Definition</a><br/>
    <a id="help_" href="javascript:showHelp();" alt="Help" title="Help"><i class='material-icons'>help_outline</i> Help</a><br/>
    <a id="tooltips" href="javascript:showTooltips();" alt="Tooltips" title="Tooltips"><i class='material-icons'>live_help</i> Tooltips</a><br/>
    <a id="credits_" href="javascript:showCredits();" alt="Credits" title="Credits"><i class='material-icons'>copyright</i> Credits</a><br/>
    <a id="share" href="javascript:window.open('https://www.blogger.com/blog-this.g?t='+res.value, 'blog');" alt="Share" title="Share"><i class='material-icons'>share</i> Share</a><br/>
  </div>

<script>
var keys = [
  " i;IY;330;0.1664;0.3341;0.1498;0.0153;293.6648;2489.016;3135.963",
  " ɪ;IH;300;0.3084;0.5288;0.3583;0.0380;349.2282;2217.461;3135.963",
  "eɪ;EY;270;0.0699;0.0026;0.1882;0.0188;440;1975.533;2959.955",
  " ɛ;EH;240;0.1077;0.0145;0.2819;0.0266;622.2540;1760.000;2959.955",
  " æ;AE;210;0.1024;0.0084;0.2871;0.0118;698.4565;1567.982;2793.826",
  " ɝ;ER;180;0.1080;0.2535;0.0684;0.0021;783.9909;1396.913;2793.826",
  " ʌ;AH;150;0.4567;1.0000;0.3641;0.0060;783.9909;1244.508;2637.02",
  " ɑ;AA;120;0.0612;0.0046;0.1674;0.0115;698.4565;1108.731;2637.02",
  " ɔ;AO;90;0.0557;0.0048;0.1554;0.0070;622.2540;987.7666;2489.016",
  "oʊ;OW;60;0.0371;0.0182;0.0857;0.0075;440;880;2489.016",
  " ʊ;UH;30;0.0112;0.0008;0.0310;0.0018;349.2282;783.9909;2349.318",
  " u;UW;0;0.0605;0.0202;0.1523;0.0089;293.6648;698.4565;2349.318",
  "aɪ;AY;210;0.0483;0.0066;0.1246;0.0138;0;0",
  "ɔɪ;OY;180;0.0034;0.0001;0.0098;0.0004;0;0",
  "aʊ;AW;90;0.0156;0.0006;0.0442;0.0021;0;0",
  //"__;__;0;0.0000;0.0000;0.0000;0.0000;0;0",
];

var keys_ = [
  "b ,B,0.2141",
  "p ,P,0.2477",
  "d ,D,0.5656",
  "t ,T,0.9327",
  "dʒ,JH,0.0791",
  "tʃ,CH,0.0717",
  "ɡ ,G,0.0920",
  "k ,K,0.3811",
  "v ,V,0.2394",
  "f ,F,0.2387",
  "ð ,DH,0.6531",
  "θ ,TH,0.0758",
  "z ,Z,0.4163",
  "s ,S,0.5710",
  "ʒ ,ZH,0.0086",
  "ʃ ,SH,0.1072",
  "ɹ ,R,0.5663",
  "h ,HH,0.1739",
  "w ,W,0.2890",
  "m ,M,0.3173",
  "  ,_,1",
  "l ,L,0.4471",
  "n ,N,1.0000",
  "j ,Y,0.0911",
  "ŋ ,NG,0.1000",
];

var kbrd = {
  '`': '_',
  '1': 'IY_',
  '2': 'IH_',
  '3': 'EY_',
  '4': 'EH_',
  '5': 'AE_',
  '6': 'ER_',
  '7': 'AH_',
  '8': 'AA_',
  '9': 'AO_',
  '0': 'OW_',
  '-': 'UH_',
  '=': 'UW_',
  'q': 'TH',
  'w': 'W',
  'e': 'SH',
  'r': 'R',
  't': 'T',
  'y': 'Y',
  'u': 'NG',
  'i': '1',
  'o': '0',
  'p': 'P',
  '[': 'AY_',
  ']': 'OY_',
  '\\': 'AW_',
  'a': 'ZH',
  's': 'S',
  'd': 'D',
  'f': 'F',
  'g': 'G',
  'h': 'HH',
  'j': 'JH',
  'k': 'K',
  'l': 'L',
  ';': '2',
  '\'': '_',
  'z': 'Z',
  'x': 'DH',
  'c': 'CH',
  'v': 'V',
  'b': 'B',
  'n': 'N',
  'm': 'M',
  ',': '_',
  '.': '_',
  '/': '_',
  '_': '_',
  ' ': ' ',
}

var tone = [
  '˥', '˦', '˧', '˨', '˩',
  '꜒', '꜓', '꜔', '꜕', '꜖',
  '꜈', '꜉', '꜊', '꜋', '꜌',
  '꜍', '꜎', '꜏', '꜐', '꜑'
];

var dots = (
	"⠀⢀⠠⢠⠐⢐⠰⢰⠈⢈⠨⢨⠘⢘⠸⢸" +
	"⡀⣀⡠⣠⡐⣐⡰⣰⡈⣈⡨⣨⡘⣘⡸⣸" +
	"⠄⢄⠤⢤⠔⢔⠴⢴⠌⢌⠬⢬⠜⢜⠼⢼" +
	"⡄⣄⡤⣤⡔⣔⡴⣴⡌⣌⡬⣬⡜⣜⡼⣼" +
	"⠂⢂⠢⢢⠒⢒⠲⢲⠊⢊⠪⢪⠚⢚⠺⢺" +
	"⡂⣂⡢⣢⡒⣒⡲⣲⡊⣊⡪⣪⡚⣚⡺⣺" +
	"⠆⢆⠦⢦⠖⢖⠶⢶⠎⢎⠮⢮⠞⢞⠾⢾" +
	"⡆⣆⡦⣦⡖⣖⡶⣶⡎⣎⡮⣮⡞⣞⡾⣾" +
	"⠁⢁⠡⢡⠑⢑⠱⢱⠉⢉⠩⢩⠙⢙⠹⢹" +
	"⡁⣁⡡⣡⡑⣑⡱⣱⡉⣉⡩⣩⡙⣙⡹⣹" +
	"⠅⢅⠥⢥⠕⢕⠵⢵⠍⢍⠭⢭⠝⢝⠽⢽" +
	"⡅⣅⡥⣥⡕⣕⡵⣵⡍⣍⡭⣭⡝⣝⡽⣽" +
	"⠃⢃⠣⢣⠓⢓⠳⢳⠋⢋⠫⢫⠛⢛⠻⢻" +
	"⡃⣃⡣⣣⡓⣓⡳⣳⡋⣋⡫⣫⡛⣛⡻⣻" +
	"⠇⢇⠧⢧⠗⢗⠷⢷⠏⢏⠯⢯⠟⢟⠿⢿" +
	"⡇⣇⡧⣧⡗⣗⡷⣷⡏⣏⡯⣯⡟⣟⡿⣿"
).split("");

var keysPressed = new Array(8);
var kbrd = {
  '1': 0,
  '2': 4,
  'q': 1,
  'w': 5,
  'a': 2,
  's': 6,
  'z': 3,
  'x': 7,
}
for (var i=0; i<keysPressed.length; i++) {
  keysPressed[i] = false;
}

var h_ = 2048;
var real = new Float32Array(h_);
var imag = new Float32Array(h_);
var fund = 128;
var freq = 4.0; //max.freq is 4*2048=8192
var offset = fund / freq;
var formant_w = Math.round(512 / freq);
var vol = 1.0;
var ac = null;
var osc, gain, osc_, gain_;
var i_, _i, t;
var a_ = [];
var playNow = false;
var h = 16;

function init() {
  ac = new AudioContext({latencyHint:"interactive",sampleRate: 48000});
  osc = ac.createOscillator();
  osc.frequency.setValueAtTime(freq, ac.currentTime); // value in hertz
  gain = ac.createGain();
  gain.gain.setValueAtTime(0, ac.currentTime);
  osc.connect(gain);
  gain.connect(ac.destination);
  osc.start();
  osc_ = ac.createOscillator();
  osc_.frequency.setValueAtTime(freq, ac.currentTime); // value in hertz
  gain_ = ac.createGain();
  gain_.gain.setValueAtTime(0, ac.currentTime);
  osc_.connect(gain_);
  gain_.connect(ac.destination);
  osc_.start();
  i_ = 0;
  _i = 0;
}

function play() {
  var ph = a_[i_].split("").reverse();
  for (var i=0; i<offset; i++) {
    real[i] = 0;
    imag[i] = 0;
  }
  for (var j=0; j<ph.length; j++) {
    if (ph[0]=="1" || ph.indexOf("1")==ph.lastIndexOf("1")) {
      if (ph[j]=="1") {
        for (var i=j*formant_w+offset; i<(j+1)*formant_w+offset; i++) {
          if (parseInt(i/offset) == i/offset) {
            real[i] = vol;
          	imag[i] = vol;
          } else {
            real[i] = 0;
        	  imag[i] = 0;
          }
        }
      } else {
        for (var i=j*formant_w+offset; i<(j+1)*formant_w+offset; i++) {
          real[i] = 0;
        	imag[i] = 0;
        }
      }
    } else {
      if (ph[j]=="1") {
        for (var i=j*formant_w+offset; i<(j+1)*formant_w+offset; i++) {
        	real[i] = Math.random()*vol;
        	imag[i] = Math.random()*vol;
        }
      } else {
        for (var i=j*formant_w+offset; i<(j+1)*formant_w+offset; i++) {
          real[i] = 0;
        	imag[i] = 0;
        }
      }
    }
  }
  var wave = ac.createPeriodicWave(real, imag, {disableNormalization: true});
  if (parseInt(i_/2) == i_/2) {
    gain.gain.value = 0.0;
    osc.setPeriodicWave(wave);
    gain.gain.linearRampToValueAtTime(1.0, ac.currentTime+1.0 / freq);
    gain_.gain.linearRampToValueAtTime(0.0, ac.currentTime+1.0 / freq);
  } else {
    gain_.gain.value = 0.0;
    osc_.setPeriodicWave(wave);
    if (a_[i_-1].indexOf("1")>-1) {
      gain_.gain.linearRampToValueAtTime(1.0, ac.currentTime+1.0 / freq);
      gain.gain.linearRampToValueAtTime(0.0, ac.currentTime+1.0 / freq);
    } else {
      gain_.gain.linearRampToValueAtTime(1.0, ac.currentTime);
      gain_.gain.linearRampToValueAtTime(0.0, ac.currentTime+0.5 / freq);
      gain.gain.linearRampToValueAtTime(0.0, ac.currentTime);
    }
  }
  i_++;
  if (i_ < _i) {
    if (parseInt(i_/2) == i_/2) {
      b.focus();
      b.setSelectionRange(i_/2, i_/2);
    }
    t = setTimeout(play, 1000 / freq);
  } else {
    pause();
  }
}

function toBinary() {
  var a = b.value.split("\n");
  a_ = [];
  for (var i=0; i<a.length; i++) {
    a[i] = a[i].split("");
    for (var j=0; j<a[i].length; j++) {
      if (!a_[j*2]) {
        a_[j*2] = "";
        a_[j*2+1] = "";
      }
      var b_ = dots.indexOf(a[i][j]).toString(2);
      while (b_.length<8) {
        b_ = "0" + b_;
      }
      a_[j*2] += b_.slice(0,4);
      a_[j*2+1] += b_.slice(-4);
    }
  }
  for (var i=0; i<a_.length; i++) {
    while (a_[i].length<16) {
      a_[i] = "0" + a_[i];
    }
  }
  console.log(a_.join("\n"));
}

function showColumn() {
  var b_ = parseInt(b.selectionStart);
  var d_ = parseInt(b.selectionEnd);
  var ch_ = b.value.charAt(b_);
  ch.innerHTML = ch_;
  var c = dots.indexOf(ch_);
  if (c == -1) {
    c = 0;
  }
  var p = c.toString(2);
  while (p.length < cb.length) {
    p = "0" + p;
  }
  for (var i=0; i<p.length; i++) {
    if (p.charAt(i) == "1") {
      cb[i].checked = true;
    } else {
      cb[i].checked = false;
    }
  }
}

function playColumn() {
  i_ = findC(b)*2;
  _i = i_+2;
  toBinary();
  if (a_[i_]) {
    play();
  }
}

function playAll() {
  i_ = findC(b)*2;
  _i = a_.length;
  toBinary();
  if (a_[0]) {
    play();
  }
  playNow = true;
  document.getElementById("play_all").firstChild.innerText='pause';
}

function pause() {
  clearTimeout(t);
  gain_.gain.linearRampToValueAtTime(0.0, ac.currentTime+1.0 / freq);
  gain.gain.linearRampToValueAtTime(0.0, ac.currentTime+1.0 / freq);
  playNow = false;
  document.getElementById("play_all").firstChild.innerText='play_arrow';
}

function findC(v) {
    var b_ = parseInt(v.selectionStart);
    var d_ = parseInt(v.selectionEnd);
    var l = v.value.substr(0, b_).split("\n");
    var c = l[l.length-1].length;
    v.focus();
    v.setSelectionRange(b_, d_);
    return c;
}

function addBinary() {
  var b_ = parseInt(b.selectionStart);
  var d_ = parseInt(b.selectionEnd);
  var p = "";
  for (var i=0; i<keysPressed.length; i++) {
    if (keysPressed[i]===true) {
      p += "1";
    } else {
      p += "0";
    }
  }
  if (p=="00000000") {
    p = "";
    for (var i=0; i<cb.length; i++) {
      if (cb[i].checked === true) {
        p += "1";
      } else {
        p += "0";
      }
    }
  } else {
    for (var i=0; i<cb.length; i++) {
      if (p.charAt(i)=="1") {
        cb[i].checked = true;
      } else {
        cb[i].checked = false;
      }
    }
  }
  var i = parseInt(p, 2);
  b.value = b.value.substr(0, b_) + dots[i] + b.value.substr(d_+1);
  b.focus();
  b.setSelectionRange(b_, b_);
  var ch_ = b.value.charAt(b_);
  ch.innerHTML = ch_;
}

function zoom(v) {
  var z = parseInt(b.style.fontSize.slice(0,-2)) + v;
  b.style.fontSize = z+"px";
}

function swap() {
  if (checkboxes.style.left=="0px") {
    checkboxes.style.right="0px";
    checkboxes.style.left="auto";
    b.style.textAlign="left";
    buttons.style.textAlign="left";
  } else {
    checkboxes.style.right="auto";
    checkboxes.style.left="0px";
    b.style.textAlign="right";
    buttons.style.textAlign="right";
  }
}

function save() {
    var filename = "phonetic_pattern.txt";
    var element = document.createElement('a');
    element.setAttribute('href', 'data:text/csv;charset=utf-8,' + encodeURIComponent(b.value));
    element.setAttribute('download', filename);
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
}

var audioCtx, oscillator, biquadFilter, biquadFilter_, biquadFilter__, gainNode = null;

function setup() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  oscillator = audioCtx.createOscillator();
  biquadFilter = audioCtx.createBiquadFilter();
  biquadFilter_ = audioCtx.createBiquadFilter();
  biquadFilter__ = audioCtx.createBiquadFilter();
  gainNode = audioCtx.createGain();
  
  oscillator.type = 'triangle';
  oscillator.frequency.setValueAtTime(440, audioCtx.currentTime); // value in hertz
  biquadFilter.type = "peaking";
  biquadFilter_.type = "peaking";
  biquadFilter__.type = "peaking";
  biquadFilter.Q.value = 500;
  biquadFilter_.Q.value = 500;
  biquadFilter__.Q.value = 500;
  biquadFilter.frequency.setValueAtTime(8000, audioCtx.currentTime);
  biquadFilter.gain.setValueAtTime(50, audioCtx.currentTime);
  biquadFilter_.frequency.setValueAtTime(8000, audioCtx.currentTime);
  biquadFilter_.gain.setValueAtTime(100, audioCtx.currentTime);
  biquadFilter__.frequency.setValueAtTime(8000, audioCtx.currentTime);
  biquadFilter__.gain.setValueAtTime(50, audioCtx.currentTime);
  gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
  
  oscillator.connect(biquadFilter);
  oscillator.connect(biquadFilter_);
  oscillator.connect(biquadFilter__);
  biquadFilter.connect(gainNode);
  biquadFilter_.connect(gainNode);
  biquadFilter__.connect(gainNode);
  gainNode.connect(audioCtx.destination);
  oscillator.start();
}

function play_(f0, f1_, f2_, f3_) {
  if (!audioCtx) {
    setup();
  }
  oscillator.frequency.setValueAtTime(f0, audioCtx.currentTime);
  biquadFilter.frequency.setValueAtTime(parseFloat(f1_), audioCtx.currentTime);
  biquadFilter_.frequency.setValueAtTime(parseFloat(f2_), audioCtx.currentTime);
  biquadFilter__.frequency.setValueAtTime(parseFloat(f3_), audioCtx.currentTime);
  gainNode.gain.setValueAtTime(0.25, audioCtx.currentTime+0.001);
}

function stop() {
  gainNode.gain.setValueAtTime(0, audioCtx.currentTime+0.001);
}

function playAudio() {
  document.getElementsByTagName('audio')[0].play();
}

/*

use CMU->IPA / add Britfone ?
ˈaɪ
ˈaʊ
ˈeɪ
ˈiː
ˈuː
ˈæ
ˈɐ
ˈɑː
ˈɒ
ˈɔɪ
ˈɔː-
ˈə
ˈəʊ
ˈɛ
ˈɛə-
ˈɜː-
ˈɪ
ˈɪə-
ˈʊ
ˈʊə-
(aə, oə ?)
Diphtong sound

| IY IH EY EH AE ER AH AA AO OW UH UW |
| i: i  e: e  æ  ə  a  a: o  o: u  u: | F2
| D# C# B  A  G  F  D# C# B  A  G  F  |
|    2100      1400               700 | Hz

Intelligibility is preserved across a fairly wide range when F0 and FFs are scaled up or down in proportionate amounts (e.g., Chiba and Kajiyama, 1941; Daniloff et al., 1968). However, F0 and FFs do not scale proportionately in natural speech. For example, the F0 difference between adult male and adult female voices is about 80%–90%, while FFs increase only 12%–15% (Peterson and Barney, 1952).


People have a tendency to think of intonation as being directly linked to the speaker's emotions. In fact, the meaning of intonation contours is as conventionalized as any other aspect of language. Different languages can use different conventions, giving rise to the potential for cross-cultural misunderstandings.

reading the one language with the intonation pattern appropriate to the other can give rise to entirely unintentional effects: English with Russian intonation sounds unfriendly, rude or threatening, to the native speaker of English; Russian with an English intonation sounds affected or hypocritical to the native speaker of Russian.
Comrie (1984); "Interrogativity in Russian"


whistled language
In a non-tonal language, segments may be differentiated as follows:
-Vowels are replaced by a set of relative pitch ranges generally tracking the f2 formant of spoken language.
-Stress is expressed by higher pitch or increased length
-Consonants are produced by pitch transitions of different lengths and height, plus the presence or absence of occlusion. ("Labial stops are replaced by diaphragm or glottal occlusions.")


noun, adjective, verb, adverb, pronoun,
determiner, preposition, conjunction, interjection

*/

var url = "https://script.google.com/macros/s/AKfycbz5br4wnfSGtucWKwGQq1Tb07eshJez6uVaFatn4xJAc_rcrcA/exec"; //"http://192.168.0.61:8080/";
var words_ = [];
var w = [];
var f1 = [];
var f2 = [];
var f3 = [];
var s = ["·", "ˈ", "ˌ"];

var k = document.getElementById("keys");
var k_ = document.getElementById("keys_");
var v = document.getElementById("keys").querySelectorAll("select");
var c_ = document.getElementById("keys_").querySelectorAll("a");
var tone_ = document.getElementById("tone");
var vowels = document.getElementById("vowels");
var consonants = document.getElementById("consonants");
var vowels_ = document.getElementById("vowels_");
var consonants_ = document.getElementById("consonants_");
var _vowels = document.getElementById("_vowels");
var _consonants = document.getElementById("_consonants");
var word = document.getElementById("word");
var _word = document.getElementById("_word");
var word_ = document.getElementById("word_");
var highlight = document.getElementById("highlight");
var res = document.getElementById("res");
var rs = document.getElementById("rs");
var entry = document.getElementById("entry");
var ngram = document.getElementById("ngram_chart");
var def = document.getElementById("def");
var mobile = document.getElementById("mobile");
var spectrogram = document.getElementById("spectrogram");
var b = document.getElementById("b");
b.style.fontSize = "16px";
var d = document.getElementById("d");
var buttons = document.getElementById("buttons");
var checkboxes = document.getElementById("checkboxes");
var cb = document.getElementsByClassName("cb");
var ch = document.getElementById("ch");
var res_old = "";
var rs_old = "";
var regexp = [];
var ks_ = [];
var ctl = rs;

for (var i=0; i<keys.length; i++) {
  var ks = keys[i].split(";");
  var lnk = v[i];
  lnk.id = i;
  lnk.title = ks[1];
  lnk.onfocus = function(e){this.selectedIndex=-1;play_(parseFloat(f2[this.id])/4, f1[this.id], f2[this.id], f3[this.id]);};
  lnk.onchange = function(e){/*addVowel(e.target.value, e.target.style.backgroundColor);*/if(ctl!=consonants){addPhoneme(e.target.value, e.target.style.backgroundColor);}this.blur();stop();};
  var bg = 100 - Math.pow(parseFloat(ks[3]), 1/3)*50;
  lnk.style.backgroundColor = "hsl(" + ks[2] + ", 100%, " + bg + "%)";
  lnk.innerHTML += "<option style='background-color:hsl("+ks[2]+", 100%, "+bg+"%);' value='"+ks[1]+"_'>"+ks[0]+"</option>";
  for (var j=0; j<=2; j++) {
    var bg = 100 - Math.pow(parseFloat(ks[4+j]), 1/3)*50;
    lnk.innerHTML += "<option style='background-color:hsl("+ks[2]+", 100%, "+bg+"%);' value='"+ks[1]+j+"'>"+ks[0]+s[j]+"</option>";
  }
  f1[i] = ks[7];
  f2[i] = ks[8];
  f3[i] = ks[9];
  regexp[i] = [];
  regexp[i][0] = new RegExp(ks[1]+"[_012]", "g");
  regexp[i][1] = "hsl(" + ks[2] + ", 100%, 75%)";
  ks_[i] = ks[1];
}

for (var i=0; i<keys_.length; i++) {
  var ks = keys_[i].split(",");
  var lnk = c_[i];
  lnk.onclick=function(e){/*addConsonant(e.target.title);*/if(ctl!=vowels){addPhoneme(e.target.title, 'transparent');}};
  lnk.href="javascript:";
  lnk.innerText = ks[0];
  var bg = 100 - Math.pow(parseFloat(ks[2]), 1/3)*100;
  lnk.style.color = "hsl(0, 0%, " + bg + "%)";
}

for (var i=0; i<tone.length; i++) {
  var ks = tone[i];
  tone_.innerHTML += "<a title='"+ks+"' href='javascript:' onclick='addPhoneme(this.innerText, &apos;transparent&apos;);'>" + ks +"</a> ";
}

function findCursor(v) {
    var startPos = v.selectionStart;
    var endPos = v.selectionEnd;
    return startPos + "," + endPos;
}

function selectText() {
    var txt = "";

    if (window.getSelection) {
        txt = window.getSelection();
    }
    else if (document.getSelection) {
        txt = document.getSelection();
    } else if (document.selection) {
        txt = document.selection.createRange().text.trim();
    }

    return txt;
}

function addVowel(v, clr) {
  //t.innerHTML += "<span style='background-color:" + clr + ";'>" + v + "</span> ";
  var cPos = findCursor(vowels).split(",");
  var b = parseInt(cPos[0]);
  var d = parseInt(cPos[1]);
  vowels.value = vowels.value.substr(0, b) + v + " " + vowels.value.substr(d);
  vowels.focus();
  vowels.setSelectionRange(b+v.length+1, b+v.length+1);
}

function addConsonant(c) {
  var cPos = findCursor(consonants).split(",");
  var b = parseInt(cPos[0]);
  var d = parseInt(cPos[1]);
  consonants.value = consonants.value.substr(0, b) + c + " " + consonants.value.substr(d);
  consonants.focus();
  consonants.setSelectionRange(b+c.length+1, b+c.length+1);
}

function addWord(w_, _w) {
  //t.innerHTML += "<span style='background-color:" + clr + ";'>" + v + "</span> ";
  var cPos = findCursor(rs).split(",");
  var cPos_ = findCursor(res).split(",");
  var b = parseInt(cPos[0]);
  var d = parseInt(cPos[1]);
  var b_ = parseInt(cPos_[0]);
  var d_ = parseInt(cPos_[1]);
  rs.value = rs.value.substr(0, b) + " " + _w + " " + rs.value.substr(d);
  res.value = res.value.substr(0, b_) + w_ + " " + res.value.substr(d_);
  rs.focus();
  rs.setSelectionRange(b+_w.length+2, b+_w.length+2);
  res.focus();
  res.setSelectionRange(b_+w_.length+1, b_+w_.length+1);
  word.value = _w;
  word_.firstChild.innerText = w_.split(' ')[0];
}

function addPhoneme(p, clr) {
  //t.innerHTML += "<span style='background-color:" + clr + ";'>" + v + "</span> ";
  var cPos = findCursor(ctl).split(",");
  var b = parseInt(cPos[0]);
  var d = parseInt(cPos[1]);
  ctl.value = ctl.value.substr(0, b) + p + " " + ctl.value.substr(d);
  ctl.focus();
  ctl.setSelectionRange(b+p.length+1, b+p.length+1);
}

function findWords(w_, q, q_) {
  if (w_ != "" || q != "" || q_ != "") {
    if (w_.trim().search(/[*_012 ]/) != -1) {
      splitWord();
      w_ = "";
      q = vowels.value;
      q_ = consonants.value;
    }
    w_ = ""+w_.replace(/\n/g, " ").replace(/\s+/g, " ").trim();
    q = ""+q.replace(/\n/g, " ").replace(/\s+/g, " ").trim();
    q_ = ""+q_.replace(/\n/g, " ").replace(/\s+/g, " ").trim();
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
        if (this.responseText != "") {
          word_.innerHTML = "<div onclick='showList();'>=> Click for results</div>" + this.responseText;
        } else {
          word_.innerHTML = "<div>!= Nothing found</div>";
        }
        word_.focus();
      }
    };
    xhttp.open("GET", url + "?w=" + w_ + "&q=" + q + "&q_=" + q_, true);
    xhttp.send();
    word_.innerHTML = "<div>Searching...</div>";
  }
}

function splitWord() {
  vowels.value = "";
  consonants.value = "";
  var wrd = word.value.split(" ");
  for (var i=0; i<wrd.length; i++) {
    var num = wrd[i].charAt(2);
    if (num == "_" || num == "0" || num == "1" || num == "2") {
      vowels.value += wrd[i] + " ";
    } else {
      consonants.value += wrd[i] + " ";
    }
  }
  vowels.value = vowels.value.trim();
  consonants.value = consonants.value.trim();
  word.value = "";
}

function syllables() {
  var str = res.value.replace(/\n/gi, " \n");
  var lines = str.split("\n");
  str = "";
  for (var j=0; j<lines.length; j++) {
    lines[j] = lines[j].replace(/ /gi, function (x) {
        return x;
    });
    lines[j] = lines[j].replace(/[ieaouy]/gi, function (x) {
      return "<i>"+x+"</i>";
    });
    str += lines[j]+"\n";
  }
  str = str.slice(0, -1);
  res_old = highlight.innerText;
  highlight.innerHTML = "<pre>"+str+"</pre>";
  highlight.scrollTop = res.scrollTop;
  highlight.scrollLeft = res.scrollLeft;
}

function colorPhonemes() {
  var str = rs.value;
  var lines = str.split("\n");
  str = "";
  for (var j=0; j<lines.length; j++) {
    for (var i=0; i<regexp.length; i++) {
      lines[j] = lines[j].replace(regexp[i][0], function (x) {
          return "<i style='background-color:" + regexp[i][1] + ";margin-right:-4px;border-right:4px solid " + regexp[i][1] + ";'>"+x+"</i>";
      });
    }
    str += lines[j]+"\n";
  }
  str = str.slice(0, -1);
  rs_old = highlight_.innerText;
  highlight_.innerHTML = "<pre>"+str+"</pre>";
  highlight_.scrollTop = rs.scrollTop;
  highlight_.scrollLeft = rs.scrollLeft;
}

function undo() {
  if (ctl == rs) {
    rs.value = rs_old;
    colorPhonemes();
  } else if (ctl == res) {
    res.value = res_old;
    syllables();
  }
}

function pos(w_) {
  entry.style.visibility = "visible";
  ngram.src = "https://books.google.com/ngrams/interactive_chart?content="+w_+"_%2A&year_start=1800&year_end=2019&corpus=26&smoothing=0&case_insensitive=true";

  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      if (this.responseText != "") {
        var json = JSON.parse(this.responseText)[0];
        def.innerHTML = "<i class='material-icons'>volume_up</i> ";
        for (var i=0; i<json.phonetics.length; i++) {
          def.innerHTML += "<audio><source src='"+json.phonetics[i].audio+"' type='audio/mpeg'></audio><a href='javascript:playAudio();'>" + json.phonetics[i].text + "</a> ";
        }
        for (var i=0; i<json.meanings.length; i++) {
          def.innerHTML += "<hr/><b>" + json.meanings[i].partOfSpeech + "</b>";
          for (var j=0; j<json.meanings[i].definitions.length; j++) {
            def.innerHTML += "<br/><br/>" + json.meanings[i].definitions[j].definition + "<br/>";
            for (var k=0; k<json.meanings[i].definitions[j].synonyms.length; k++) {
              def.innerHTML += "<i><u><a href='javascript:' onclick='word.value=this.innerText;'>" + json.meanings[i].definitions[j].synonyms[k] + "</a></u></i> ";
            }
          }
        }
      } else {
        def.innerHTML = "Unknown word";
      }
    }
  };
  xhttp.open("GET", "https://api.dictionaryapi.dev/api/v2/entries/en/" + w_, true);
  xhttp.send();
}

function loadIndex(f, v) {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      w = this.responseText.split("\n");
      var options = "";
      if (v == "v") {
        vowels_.innerHTML = "";
        for (var i=0; i<w.length; i++) {
          //var wrd = w[i].split(",");
          options += "<option value='" + w[i] + "'/>";
        }
        //_word.innerHTML = '';
        //consonants_.innerHTML = '';
        vowels_.innerHTML = options;
      } else if (v == "c") {
        consonants_.innerHTML = "";
        for (var i=0; i<w.length; i++) {
          //var wrd = w[i].split(",");
          options += "<option value='" + w[i] + "'/>";
        }
        //_word.innerHTML = '';
        //vowels_.innerHTML = '';
        consonants_.innerHTML = options;
      } else if (v == "w") {
        _word.innerHTML = "";
        for (var i=0; i<w.length; i++) {
          var wrd = w[i].split(",");
          options += "<option value='" + wrd[1] + "'/>";
        }
        //vowels_.innerHTML = '';
        //consonants_.innerHTML = '';
        _word.innerHTML = options;
      }
    }
  };
  xhttp.open("GET", f, true);
  xhttp.send();
}
loadIndex('vowels.csv', 'v');
loadIndex('consonants.csv', 'c');


function showLyrics() {
  if (res.style.display!='none') {
    highlight.style.display='none';
    res.style.display='none';
    
    rs.style.top='0px';
    rs.style.minWidth='100%';
    rs.style.minHeight='256px';
    highlight_.style.minWidth='100%';
    highlight_.style.minHeight='256px';
    highlight_.style.top='0px';
  } else {
    highlight.style.display='block';
    res.style.display='block';

    rs.style.top='';
    rs.style.minWidth='50%';
    rs.style.minHeight='128px';
    highlight_.style.minWidth='50%';
    highlight_.style.minHeight='128px';
    highlight_.style.top='';
  }
}

function showEntry() {
  if (entry.style.visibility!='visible') {
    entry.style.visibility='visible';
  } else {
    entry.style.visibility='hidden';
  }
}

function showHelp() {
  if (help.style.visibility!='visible') {
    help.style.visibility='visible';
  } else {
    help.style.visibility='hidden';
  }
}

function showCredits() {
  if (credits.style.visibility!='visible') {
    credits.style.visibility='visible';
  } else {
    credits.style.visibility='hidden';
  }
}

function showTooltips() {
  if (mobile.style.visibility!='visible') {
    mobile.style.visibility='visible';
  } else {
    mobile.style.visibility='hidden';
  }
}

function showLinks() {
  if (links.style.width!='144px') {
    links.style.width='144px';
  } else {
    links.style.width='28px';
  }
}

function showList() {
  if (word_.style.position!='absolute') {
    word_.style.position='absolute';
    word_.style.height='180px';
  } else {
    word_.style.position='relative';
    word_.style.height='18px';
  }
}

function showSpectrogram() {
  if (spectrogram.style.visibility!='visible') {
    if(ac==null){init();}
    spectrogram.style.visibility='visible';
  } else {
    spectrogram.style.visibility='hidden';
  }
}

</script>
</body>
</html>
